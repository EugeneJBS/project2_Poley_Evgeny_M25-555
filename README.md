# Простая консольная база данных

## Описание проекта
Данный проект представляет собой консольное приложение, имитирующее работу реляционной базы данных.

В проекте реализованы следующие концепции Python:
- **Декораторы:** Централизованная обработка исключений (`handle_db_errors`), подтверждение опасных операций (`confirm_action`) и логирование времени выполнения (`log_time`).
- **Замыкания:** Реализация механизма кэширования результатов запросов для оптимизации производительности.
- **Безопасный парсинг:** Использование модуля `shlex` для корректной обработки сложных команд с кавычками и пробелами.
- **Персистентность:** Хранение метаданных и данных таблиц в формате JSON.
- **Форматированный вывод:** Использование библиотеки `PrettyTable` для отрисовки таблиц в консоли.

---

## Требования
* **Python** версии **3.11** или выше.
* Установленный пакетный менеджер **Poetry**.

---

## Установка и запуск
1. **Клонирование репозитория:**
   ```bash
   git clone https://github.com/EugeneJBS/project2_Poley_Evgeny_M25-555.git
   ```
   ```bash
   cd project2_Poley_Evgeny_M25-555
   ```
2.  **Установка зависимостей:**
    ```bash
    make install
    ```
    *(Или `poetry install`, если у вас не установлен `make`)*

3.  **Запуск проекта:**
    ```bash
    make project
    ```
    *(Или `poetry run project`)*

## Основные команды

### Работа с таблицами
- ```create_table <name> <col1:type> <col2:type>``` — создание новой таблицы. Доступные типы: int, str, bool. Столбец ID:int добавляется автоматически.
- ```list_tables``` — вывод списка всех существующих таблиц.
- ```drop_table <name>``` — полное удаление таблицы и её данных (требуется подтверждение пользователя [y/n]).
### Работа с данными (CRUD)
- ```insert into <name> values ("Значение1", 10, true)``` — создание новой записи. ID генерируется автоматически.
- ```select from <name>``` — чтение всех записей из указанной таблицы.
- ```select from <name> where <column> = <value>``` — чтение записей, подходящих под условие.
- ```update <name> set <col1> = <val1> where <col2> = <val2>``` — обновление данных в существующих записях.
- ```delete from <name> where <column> = <value>``` — удаление записей по условию (требуется подтверждение пользователя).
- ```info <name>``` — вывод структуры таблицы (схемы) и общего количества записей.
### Общие команды
- ```help``` — вывод справочной информации со списком всех команд.
- ```exit``` — корректное завершение работы программы.

## Техническая архитектура

- ```main.py``` — точка входа, инициализация и запуск приложения.
- ```engine.py``` — основной игровой цикл, обработка ввода пользователя и маршрутизация команд.
- ```core.py``` — основная бизнес-логика (CRUD-операции, расчеты, валидация типов).
- ```parser.py``` — функции разбора строковых команд и конвертация типов данных.
- ```utils.py``` — низкоуровневые функции для работы с файловой системой (чтение/запись JSON).
- ```decorators.py``` — реализация декораторов для логирования, обработки ошибок и кэширования.
- ```constants.py``` — конфигурационные константы (пути к файлам, валидные типы).

## Команды разработки (Makefile)
- ```make install``` — установка зависимостей через Poetry.
- ```make project``` — запуск приложения из текущей директории.
- ```make lint``` — проверка кода линтером Ruff на соответствие стандарту PEP8.
- ```make build``` — сборка дистрибутива пакета (wheel и sdist).
- ```make package-install``` — установка собранного пакета в операционную систему через pip.

## Демонстрация (asciinema)

Ссылка: https://asciinema.org/a/1kp6w8FnUMLe3r1K

## Автор

### **Полей Евгений**
### **Группа:** M25-555